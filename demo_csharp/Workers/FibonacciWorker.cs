using Common.Log;
using demo_csharp.Generic;
using demo_csharp.Workers.IWorkService;
using System;
using System.Collections.Generic;

namespace demo_csharp.Workers
{
    public class FibonacciWorker : IMasterWorker
    {
        LogHelper logger = LogHelper.CreateInstance();
        private BigNumber bigNumber = new BigNumber();
        Dictionary<int, string> index2Value = new Dictionary<int, string>();

        public FibonacciWorker()
        {
            index2Value.Add(59999, "50112071570566643687928764963196396067447999525456895950737388237376629669867867088292575287986338788970595701293980877966685404691031985196753834778860059576420245629630107268756970448740761198191545409789862106794206003215963989639997487670224424248695633615364943342296815051954704035175217131614343527224558695891812026286190370166475912563777193546155752420477560368014312164674019063532258035118009454426250040291284543323119493898195191994853311592663165182603797960934851934566494934450819164081940740702209564431142238260932716368454727920152109400987488476559759770120233144892503806531784263574852561075166069772613959018612298878934024199669169344511915972210462948848644360085648425505927956872324714012978097441770173916885204683498473388660637600097230096279068619648332177480518520783663887153035361248189087008358764299584832998570888544673810261024161946282197114255259566753204943904708372801493654901317218176989865738186549775505927946609368321028512402951355129575678396075828126604253536345772640582824630424011691798192399713455096921579722313739063658091333060300506398769555292727719413503588277108604878341981570221680772598575772050174487639011893157390658094814925284526469951239235201213105319601633696873212425261143349379832497569893605523317248855953685635855036363250549554642932506341896504933253879679169247213833005968550235447649835494649798073025301433840056756349929793845533894138496430760388135520855649748810653079225055583096115986853494825787742960067516814306340429560356212666378022596590175252855903909690800969091828202564808698346963071523124066283243404121841741586728169113989922682692812622342268784818353666868853706867919442379521252300437063787379870036056610675442506172993044001380670905231024423284029838358031530640342995744681194605224211999726009567848290959974044243237739479233554970744839670572400716224468091459915327179636640829667919362098877648865675426501647328153127121350624576386633796625745072822144115885316409547162962452935465564359809099422506396923837767771226846214747860548078839418791923457326086630280199327172257481178723955812422706626179938851685619283418445392570566054192215417806957948684847088698027421330587079308761473226772101030888599324872921156168527357485226652864737357981831236370144231322624578409508848142538231059468070662982881626653346114143201410884658280820854201506814439015487329512932983417426694031809439861752769799880432241773673530245864430005857026036715422537523970903242420337289775077252750016199639731363681249030908006349050299754217187313548670889673630949604591607109497998096994156995604357802687262171720517281160056156526038494734850200882481499381174921415301598593771072169853575777668722121503137801348724635745234682805259296177023337230439042369175333203618024012292486472561886864346554653397844862052654835393427085963174786692003058853266597083441946568819209433944892085518399674138402763355964682853618934296348095338645351339957647448657968797739926748143481286451273035410739414128110421130397760843405474829276451487636456449081104875188706279394202047626560928095531885593199196471535305544261301771595218590379954781021755048014827888345661100875431618588431208754082747296831831667252293861067455487814461996736314385662595458932264787544256233584767435526988491365598491921414661584908344316408881955491729201758396194458056487669992481955295458155253336383582166282268930523785513225074982217502952167189210284159562078130565092107885297205940732751572239753019895966519990370072586524114288585952027367605988533202839666424617659319493066092836063518044896226638711478484328400809847102834421148679803936895473610502113957372372371959421021498107748332564132733221970612609210742397685116033967205159471386616599547762958964762009918748735630269664237344972379117244920839145517669125313431252426888974980932462910962685367861272698749687492202335814806523553776819725146262353323003807296588466588013270156953615334513238067749754377523077125469356232332139073632494285045379482813047160757370677798064840404622796750272518832615071843350060420489119226475500242742004976317964770958598876326874487571571584978852238133987401848979136684943892813330821383851886546227172605302369817946391449771783639661458805070748253857130288394291369085073013127522480113363500978928104058660602092389662970892213817130177133409574961653085447837814584953707830519527388727045580956554092413965411197202807713201617400913935353608232429145375227451100611592598759543756746730282413555476678978978026004596028047356357145160336293188530300311241024259587516929745700864512968764920443810049570113318137707887854585534004794102925855533184617209406915908369005549790251213415244072801889525021902618841758677699246016990328970821882159799598876181383861184500285310716585429778748786625113693656481140664875667494060455128151715046959895914907671475675752528232552558611823275660859731893737725451450912373808297080711432378296107712668037392241231996379357854394831573378032693891838272250978205421538413630443241072118140908749444519824017702560067906314267505456424187748603334516728984979170320151468626057066755008168010187011819236711417245902650448680034860219463808948628237126209995109763028632216649143367198898355925832597926506019116195697081080775757048498237044948345734248023326739694011800283582600569996538111487664601938078139119720868844502239049914720109673747660613068835613317708861050845199736484337114368414730930206053509746631572318870879138950401463738217608859952966921802843908380402392533301638931676296102125616411928135296504727330645796974553834904796248707618310240726861173901318722338122265035265963999461031040119829345157318953058522922647235254970120609979221273461820187196963568792643330307771792294223686056398616915733394979104911574656543562564412057067162171951963709545288708796692457325583533654948490424979768781690498700490658501975409631636079046048737845456489730735349617298714576162575762082050466941247411086057898910872970595880001481623647041949461961626812530762401468096963256691310219462518926951065105971500517688749504095267345331349814978149691842854163082402173447895115261333384814445083356538049069342362123453346132616609713874927984613640827218839834498363140804460698715973995600459890811551350721035595613179991661413011153443738582416722855875286889934385154540595120579979457436255769454473283063417419916396908304367204835869857327115624291122456712034551051674592454392630466656425517482006444103379944753361729493604445550879649642801501281675294741855904049988004019349621488193055487923847094986648454185529547389353678236672865556508044094886934293047805035151336939153041701707318595982589102131313840895506097131421095339675622154320468323906817166189504788051917366927707338212074938813201803458760507724808281961066828452415219638341081542958053152133065945445955936777017828145653179459700044791763439230561696154471015399802958987482102520236801063700969321806783288524322077650592033903793859654440230726162570390536275182428618927981188795094303485131351434595674236185710133984965489617347311777823961509425262354308738742277643481331041970225817783440432716670242225259330254238893128581152269843338954693819487257978925936494887608189156949876852736761205002363228153179748949843337288816761340965938481561700888858390264880500519307188206317310255618857455610959912257183962978382003545459336375865453572438414230827509066755705647213268608228509970986279860902893687212679559464887473599194221755334182338668725519270690462297193797045828357075478061107997064741657747212371556867226331649149612792227786815836949392098995342756055347858928533783160873688450680352546605939830412666968504131774978027532905794215299988646803411149176148979286794795551722777281370339374676946101048228489464276113790820734705908493432634989445088985612701184644185802879448555997647186153563306217567005896544163123726036347558797700230577680016677191225244353449056063236224333641348807300568985095750003315854515112112336242360720680258335335268885083932271190070861898013996079982626050247284878172289381324583862365530933322751829233678621309897476128852197779134778294474163648894652288391702294935297377303605177930079900805096347250545328279738281671613746194848289854438805450314422248885518362795787979156720758174996202410211913451995400872631385291809528851071267319106473384221292233076332849403545596945603339107528443591657155305019566388513757981205769125599048872446881125658638150867702999743826602898127689346854957005701363314491267709979055535188926237386387739438236911982133745103299446971216152894513101711078083501170157824726714952060537646393311114323168716441853495067027735062667036733673444536695657875435977429318663504363332053161939934343184996125418488856031729212688665758922169088261169671230215606403942664437562595010967358846554756804628688538577581285732984411791225872493621062328743273974799089011128601940606065033196830250754580623646304757327800864424316645395987543378537491264965079456230368832847918737366809744388570306584290112600614166270785480087260827271121817880392579352542634897643717750479635750835834649268153658304117849804148220366478663574708940658885797697473418355053493122732059904033422738272006005825433420787422428261305748543315735253898801533023942698602778281420716985000867204247388353157638943104988541699273719000194815337042714933680382797012054376524639217627338066819075218944387059817778310617023739662356339861160437310889859890441410006381005912612304090959218451334110236583038799592054270538998962019028926873168043604463859156910719207226325929458909044919562424188197987588025626495802976327961790311325596286272761188745765035669707921629335139589828159296558753204264932739897358934344615741908583263869482202248730874444171603280953065507787671742305296158032217278116153671637182195787638513437182714981267019533833092416463278569417745841646878455592962971971146912946268477785602674558075345921082135226910582512708586974079919529026930997704597712380389323196471453938813404261496163002078313146880766958148732087772760339760241880805159306416944914804665808509506936800270420115469168179743740268280622068892142697092961676712190157022584179052020212575139877961821429407486516150605008819320167164053583434047016026657920913311380378159403794833151840463485036575627772924962738247262635705875648231384861633308939534458192726622140752774920411240147023029882316075078975076091913328782690375303989792745008538594672835686723136490391565419233250197259984326792897660509163753861123197566119814710623204597139144514534203333906249325342929967106626915862489677093325340580467456356117180258968279960440328695900804851125298624291732769203222371262537703923350576507979519651379798233749440123605078996721626868728864948114915287445280758431032678644859957938583032881845728252904153206845370484943352403136541647110407668211138331330708354523750910823201327512789352554872107839035501783374200074302561116619306144591551378978287032327511293118350136830488474382792860148205451457342742309229510838000918577141359724728354612931957259013434278547149834116169562772218470873597650603619269519509615264305770048893437379209346298478378666258447071904830954188228958726983280504308618007793036797907000023658590850869569540377780273230885758743246376304504262945688562728868120287333851507260128429122136565039291825415701230368481649415667140755146823532522089451194149027295379314123394621562531992468746351664307872386548963017940025585879045482516962471783795261971374928201220139895196031580937881614574428023554130426760211384292643161814633224710174985283768738823037978652959026321706662661041110157373478253712879937133799294607760940341100733740592868661687386651852714117683013037707335692246799382656563873421129183331851003128384871032910503028962433742472925650859001837236538800413011024155633045860811273703989229441219347451509289612330126487900195465506736745614900462714968891943057294526392302435094124770813517827567253008671721854598578261315842201768645656580197740002984757563077698853736494527091633070837650957511588834464807008135282004362211443894831501756808843488875650183552434987413681055895857293742931088646315409582266637236630396294796156485275195982964557911301322670535824015142960241245146203749880566971690604115593714575627925574323976164470575305720125832890614114849201565172725285700890899991715295022605191637073596714557211047789395493155978265739402318078975826295163153213222189995835876187036902040001");
            index2Value.Add(60000, "81083035047844154209781871661671359335391126111721076568120905947775816502193193341339574085651800748566484071936540485018581511749757847053653268595131784477801278358039112757472823361407211787550304302403272317382096450738966692446720208260462068050316293747790408487136619995853969726037245490080890393213764892888937064884706011015230308145309459330741501823062547810880871239445392991665812232867170619137764950086953686524285905206333856919123995509276496573313725835998582425513996363607589698237340911009493666029530669766004758714452698968189363936619695747654823424201098316206243045558666529387263579696220795611222461192179783744465846641692948942370744235923375116237836239675777747804930447453928052989004664287074770196297462675137363137155949820428215146666121853468695030386116314689296791775284229660632224986136847764591975784386377641956205410553256806343890047858852373946797360120557896194965796838472974850897107376782651117935341428535050666921037658508428800716352270569417284963902980117208840403358600148897019829786659150912878158661470005368489858771082418820579693758234532423528419143043551380331089427223869985184540055294651864450291836941613637279176534947480423837139895903657839447160444294362736490106988971695143595522511570324410335818406139987559420351542351533709509277329292131205058288806633191160835243868301619042579571198793396178409771062741465316551202022455702539910050964426823115981711401371360907701327496696151447135791147073119680973226946700910156900328800868540209270546181944376191667792498873864185532059869960255186443905093963015490892234096362998512865613689411526014937262378278280179890181879096735077510556940028481670622997830900567855226091088092482754055859874333835665640483063133973816689851575720498751860609710502379454173298479155149991151601444725469920206390472017921244753266755232023380533751597772667337078870815402108771264859066863169289739110879309106723506222600599913375558691633293881243179658417982530157075455281173730759310764212140460869383054464188358977177756935291305678710827802920012377193943713889297001620447018604775919236884446478984542242880285813394375151857204057263620990592072833909520673647679171328808600753846207462773170213070750640455620101576803108286841111201001556232115066193744768532762895952678186960949162241690182210406743865152448026323683780865840297689429394790842515246052764100145497589735703458798536149596275550620864339318917620639120404213138713835787550635372753596003717712650388342009266142579467207031515099906453223570011737662769538765999357869272744627185029005600603322451617532267549589325602645186959369156344647041044265714920636411241197643636808680245108542331652974267275300523480805764841288813925967561229505725866523301178506497121281030661058677675109325105551633449241599187050934983865903654007607435465946314193190425820044690722075463712413379837984604062584436364715313009138753695040659616573842121157719074133896539001359137135553714446540645559042917581714529989077896447181957552097101275333749832691605941342582334149452345721852303629615176726487706525406333281156249363913399705444059977504649037533045072519948307552059247872368802920553218197384072019462929188638740910232709063724403943794157565792474372582923588332506795885537434802562867077224497303596222306543569690169334076099113283542981595374245923701734579185921169460424836593320704897703275246215356463455394891317018262677261702776753846748397553966568985702548668421798971923770909210004561981281427455561326279456643755965160631358102987944224965695617129655371411994734437836514580326156221496267822778753915739634668473838382578947190461560023410036211953140745468847212500727770339345037073468082243980678212166952150276582189923387900804117569422662618936078625845493982756637187149065538212382281444310105675764978488459695283469170573772610735074346286171624779809836828329356630034485027658270319073220488134715532412203231407884838224971334105832775316272806451620700701559025216588712862878742748678560186422929057382155715408751123118204373785699937262837820937301827680737015255279741510344999262068900974882703310419685986866449395445496702993264713780950727937346729558758351274224428493732701366421700557937335643035999349746192220532351443045128946614606821031379504780987798538598865788200481088241400184166635591323778653282965094897551281126451488637141486779383449479244980598799213891926334768843455822665299331861037073720079426399032556821268547044439950116766056679097805243101481985805192731353635793295665816639414162683348330204646006116212172475343642617491312840571984789759862286322147528036523482443204102081122372231511845184780456264737976466734272157403863350140708464696524485262509836678663180939591304056565062321243479950541410704623586415347724833569103329047506843348819183759252190389869033900560234152807644116551433777455090069541898514855100413166649177261105993839746717043040255945229741136837003274972488147306777882446268161159507536481373376453162614471254650375676904837259141621875195148828978147970098667551201040206535144334577778999213197887275799357823417381344282168774955144853868512528081771891446469017936251505415228242276231679311223739291322771997227430258214431441436391962291623230605932088497072572519309134844965490700764407347573399259903611428731819357717822920555981582392063278738821893600901504205172241753623176844173984852251607367697052549515259593799211600798017614058099387583305346252550850759293505015198679343940359298269182419963148036657129829511368773776195211159669615790133352976968243382905190244133635234952140583148359865081395444453908077595155033609737359551243373387913889339016116675188807327387972349582040184698556129874319847700992704594177519855975461994131252415553166149791622886558009495011289634952622983167474376413787576288435075084477321602599483873435869470817474064302739445623140844560120130919629028681273010522413570135654992698603833148572402533967982312760075371704061410901451500332865131033552997190892394708977616819755758872625599492521199435612745684078211418610380369515971919240635201010774301310792851085804515103393367342631858897873680099717983689523640704477718722772313201266394096123221440643136848984766540386798684782322942022486339094813222177507939722361255972584989220672576639194530279372603797327261797188362370649849417331567721854952073218107368925924151111058067134195468418137349285017846256973809515616603514798632021877944641102641862932425035235727649413883718169734915130198799311870918524413837715335335822266075199442188414393859972366201661720785148520773974570565623407312324301397644343583461731202401426134186243165291291525335081298945780274726955152510778217296238978661154547221326451046410729396006702221275957072999721737782571363617296004374231121616695731794687026298469932372126392264327358925356008924034913139017846212986229579837629244381964153981776595711874905020216227789038840419532337368830735419589828348306756601327986620622653821517193185299310067516777911918355666252870010450723961282341239892678502816104621250005373889827535831279804341263743563316266045063916878141675892449315814115801411516273226627096032714607766299299371989922386594909471714022147778588008252183883883413845290919454886707321193098007116368648951591257969244628607508616412282866117679761235498292996871986996277684349156646606334722423676514210955944934473005790962425057466582430471284046615750743953079481377681260444961713951448041774028933251589699903238016013201777704328265463136650323389251369301160742044218875105181411851031865055833406490104956607221574303746906854901507673589549276349736980912011932074921449068106059473808272819963426454669376715244665000956629579769001091200127723012835886122636459083434099510061730760276745471458198112170354676541845986606591015581972777682023702513377244362532947277834173538619092505124824653122179001754586272146693820123716409610941782704701343489107281046291520183276890128746080753488821024842346021305275332752760487258823174997105377269885347606253718699053154806528462117280673363961572754727229720036618606521021256495863560271989412042363726552361746367586034442687867663089519817089520893521924491195166690148080276996692849760858436920383741304757943556557902794689324856979034079598256334343516038958146840582659558905758738081554128017990644587436616639240439498930636982123204076864551576457735078579070792462832891934987597195816841285874098946944959242287234247307075564660301890373643313885033896207859337702713694963173294170215565363272791660971914093717012245936915767869909223964843623824185203146882556621830879286114666967332186416794047066705076318045867588234723589424977985090777616041579915471848624020492878592624650718652480743611833247916192901246999997724793935060339460411588581005188209009301332054688038074924297370109369027942486683016464019655629207434415417025409013548774224896770626960849765420418367163600874674516295258154571601983992482287902352392124872536919865067261948322249588488048528325928769804695272929357857213565226573254879894933917004917358002774306337886093152563841286283304302110224983661344836278413967688321236628297668740522100147091789591784856310666414510606753416581781135905566897194075507560172180596797590383073566161241768612582523970873950883042652252111408914089349398778261771948702316825805303504165001432602770340948656357022672624336836382185276982041438909890754784272529534034874887262336321624939607167960308777573274248013439825882142219182369578670030552604413157650413437807804149786608182274738487664142888695087921729828061297989913714845486755811404684883127372721252761047439600973410483021700348554904502484528710168621702053852580029701035767703219642699600708464579730173923016031699549668591322383238368565914404259606122430875867004619178097310998251039714565330852983537692938638292301135545769578716922717304485476156922964748679347976954698376792889687840817803403852231413018492767775186928814648121903922052731718539409691709612903793371484293179703094705759637957547636145264045777287922849583561013709548841084990735773240359421896373302462288272659127291769477174661280744397503376826134665512223239866483062794982275123146223934276796577875284684220565966194266223104021587040690802935177136607896163026962164215298554148104384033079053489454541031113806430074317063717976219351189299147626184296099212791365561070696628433026255181404641612920162033228052160715183361751610301789638088095552768045051627893868237478185498587217746785250903846150557195544856839967262499362349206756227476591323165148532639486937553484799741080126753856187314295351666440434559871789449777529305029423463294599400480016868470784161388753332979726512973532063252613699495900959369518762589158932945134558523096807421916848954966383132446703001604843982516151498246915257708862409541104103667811759592756476840174395140585963742121484075555094656330158111965770349058308558986707359285312258303650738410651620861080171261525027108193289789191949808515207273052450542082438746484231263524481838735089719452312237419219542251581416763477189930865088575859908057465809998376963590163230217348576337709478826444210273705955677807171141050080963292308531101098586002318755751983109272784373868441005922662084466215167455386380358059507093580626344313344423195825158786599499666388649031708257424210260341177787751864940369198141259790603296334494395869435129059759771056009538341611569446250565755503727191866904597348820377488038440791916825020804399962228188775235693168864390403285378453715716985827073342459892486585173905714787275723077673721497790750107933276678474514024913252307126032170341005430758178784347148887494171249955777101468583039725008165059736483108146467197537083056482575974426034811750431014004750798320147377109687859993993205294333742329167827540673716491955901761537395783743958657076505643684830644124110338850318242633637384061314060729337039700015097975211202652362057580160522917703454276693633240123994520136895210553366299069328267234148913756629372728158543673010828893338014340836998048511924174892111435260775170845214718622281870316067205867084303077322448288048166101478998410531866039054824898749044597267060924107110423603783944012692728080177386631441987894248927604638758999013054457614185039130294584528894748770742777204225548016407833425167492507351326138404873600668903368953228680299652104085339458450553946832733158848232166783160026604057812149300551495506179708155793413808794237002095608806734195920000");
        }

        public void Do()
        {
            for (int index = 60001; index <= 70000; index++)
            {
                string result = Fibonacci(index);
                logger.Debug($"{index}:{ result}");
                Console.WriteLine($"{index}:{ result}");
            }
        }

        private string Fibonacci(int index)
        {
            string result = string.Empty;

            if (index <= 0)
            {
                throw new ArgumentException("无效的索引值");
            }

            if (index2Value.ContainsKey(index))
            {
                result = index2Value[index];
            }

            if (!string.IsNullOrEmpty(result))
            {
                return result;
            }

            if (index <= 2)
            {
                result = "1";
            }
            else
            {
                result = bigNumber.Add(Fibonacci(index - 1), Fibonacci(index - 2));
            }

            index2Value.Add(index, result);

            return result;
        }
    }
}
